package com.tjasink.adventofcode_2020.puzzle_19

import com.tjasink.adventofcode_2020.common.Solver
import com.tjasink.adventofcode_2020.common.loadInput
import com.tjasink.adventofcode_2020.common.runAndTime
import java.lang.RuntimeException

fun main() {
    val input = loadInput("puzzle_19/data.txt")
    val solver = Day19()
    runAndTime(solver, input)
}

class Day19 : Solver {

    override fun part1(input: List<String>): Long {
        val recursiveLinesToReplace = emptyList<String>()
        val matchingData = runForInputWithReplacementRules(input, recursiveLinesToReplace)
        return matchingData.size.toLong()
    }


    override fun part2(input: List<String>): Long {
        val recursiveLinesToReplace = listOf(
            "8: 42 | 42 8",
            "11: 42 31 | 42 11 31"
        )
        val matchingData = runForInputWithReplacementRules(input, recursiveLinesToReplace)
        return matchingData.size.toLong()
    }

    fun runForInputWithReplacementRules(input: List<String>, replacements: List<String>): List<String> {
        val (unreplacedRules, data) = splitIntoRulesAndData(input)
        val (replacementRules, _) = splitIntoRulesAndData(replacements)

        val rules = unreplacedRules.toMutableMap().apply {  putAll(replacementRules) }

        val numberRegex = Regex("^[\\d]+$")
        val letterRegex = Regex("^\"[ab]\"$")
        val namedGroupRegex = Regex("^\\?<r[\\d]+>$")
        val referencedNamedGroupRegex = Regex("^\\\\k<r[\\d]+>$")
        val referencedNumberedGroupRegex = Regex("^\\\\[\\d]$")
        val operators = setOf("|", "(", ")", "?:")
        val replacementsSeen = mutableListOf<String>()

        var currentRule = rules["0"]!!
        while (currentRule.contains(Regex("[^\\\\][\\d] ")) || currentRule.contains(Regex(" [\\d]"))) {

            val newRule = StringBuilder()
            val ruleTerms = currentRule.split(' ').filterNot { it.isBlank() }
            ruleTerms.forEach { term ->
                val newTerm = when {
                    numberRegex.matches(term) -> {
                        if (replacementRules.containsKey(term)) {
                            if (replacementsSeen.contains(term)) {
                                " \\k<r${term}> "
//                                " \\${replacementsSeen.indexOf(term) + 1} "
                            } else {
                                "( ?<r${term}> ${rules[term]} )".also { replacementsSeen.add(term) }
//                                "( ${rules[term]} )".also { replacementsSeen.add(term) }
                            }
                        } else {
                            "( ${rules[term]} )"
                        }
                    }
                    letterRegex.matches(term) -> term
                    namedGroupRegex.matches(term) -> term
                    referencedNamedGroupRegex.matches(term) || referencedNumberedGroupRegex.matches(term) -> term
                    operators.contains(term) -> " $term "
                    else -> throw IllegalStateException("Found unexpected term \"$term\"")
                }
//                println("$term -> $newTerm")
                newRule.append(newTerm)
                newRule.append(' ')
            }
            currentRule = newRule.toString()
            println(simplifyRegex(currentRule))
        }

        currentRule = simplifyRegex(currentRule)

        println(currentRule)

//        val superRegex = Regex(currentRule)
//        val superRegex = Regex("^[ab]+(?<r8>bbbbb)[ab]+\\k<r8>[ab]+")
        val michaels = "^((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b))))))+(((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){1}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){1})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){2}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){2})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){3}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){3})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){4}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){4})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){5}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){5})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){6}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){6})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){7}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){7})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){8}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){8})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){9}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){9})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){10}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){10})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){11}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){11})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){12}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){12})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){13}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){13})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){14}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){14})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){15}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){15})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){16}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){16})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){17}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){17})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){18}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){18})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){19}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){19})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){20}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){20})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){21}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){21})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){22}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){22})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){23}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){23})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){24}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){24})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){25}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){25})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){26}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){26})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){27}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){27})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){28}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){28})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){29}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){29})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){30}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){30})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){31}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){31})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){32}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){32})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){33}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){33})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){34}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){34})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){35}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){35})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){36}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){36})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){37}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){37})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){38}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){38})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){39}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){39})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){40}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){40})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){41}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){41})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){42}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){42})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){43}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){43})|((a(((a(b((bb|aa)b)|a((ba)a|(ba)b))|b(a(b(ba|ab)|a(ba|aa))|b((ba|aa)b|(ab|bb)a)))b|(a(a(b(bb|aa)|a(bb))|b(a(ab|bb)|b(bb|aa)))|b((a(ba|ab)|b(bb))b|((ba)a|(bb|ba)b)a))a)b|(b(a(((bb|aa)b)a|(a(bb|ba)|b([ab]a|bb))b)|b(a(a(bb|ba)|b([ab][ab]))|b(([ab][ab])b|(ba|ab)a)))|a((b(a([ab]a|bb)|b(bb|ba))|a(b([ab]a|ab)|a(ba|ab)))a|(a(b(bb|ba)|a([ab][ab]))|b((ba|ab)a|([ab]a|bb)b))b))a)|b(a(b(a((a([ab]a|ab)|b(ba))a|(([ab]a|ab)a)b)|b(a((ba)b|(ab|bb)a)|b((ba)a|(ab)b)))|a(a(a(b([ab]a|bb)|a([ab][ab]))|b(b(ab|bb)|a([ab]a|bb)))|b(b(a([ab]a|ab)|b(ab|bb))|a(a([ab]a|bb)|b(bb|ba)))))|b(a((((ba|ab)a|([ab]a|bb)b)a|(b(bb)|a(bb|ba))b)b|([ab]((ba|aa)b|(ab|bb)a))a)|b(b(a((ba)b|(ba|aa)a)|b(([ab]a|ab)a|(bb|ba)b))|a(b((bb|aa)b|(bb)a)|a((bb|aa)b)))))){44}((a(((b(([ab]a|bb)a|(ba|ab)b)|a(a(ba|aa)|b(ba)))b|((([ab]a|ab)a|(bb|ba)b)a|(([ab]a|ab)[ab])b)a)a|((a((bb|aa)a|([ab]a|ab)b)|b(([ab][ab])b|(aa)a))b|(((ab|aa)[ab])b|(a([ab]a|bb)|b(b[ab]|ab))a)a)b)|b(b(((a(ba|aa)|b(ba))b|((b[ab]|ab)b|([ab][ab])a)a)b|(((bb|aa)a|(ab|bb)b)a|((ba)a|(ba|aa)b)b)a)|a(((a(ba|aa)|b(ab|bb))b|(b(bb|ba)|a(ba|ab))a)a|(b(([ab][ab])b|([ab]a|ab)a)|a(b(ba)))b)))b|(b(a(b(b(([ab]a|ab)a|(bb|ba)b)|a((ba)a|(b[ab]|ab)b))|a(a((bb)a|(bb)b)|b((ab|bb)a|(bb)b)))|b(((b([ab]a|bb)|a([ab][ab]))b|((ba)b|(bb|ba)a)a)b|(((ba)a|(ba)b)b|(([ab]a|ab)[ab])a)a))|a(a(a(((ba)a|(ba)b)b|(b(bb)|a(bb|aa))a)|b(b(b(ab)|a(ba|aa))|a(a(ba|ab)|b(bb))))|b((a(b(ab)|a(ab|aa))|b(a(aa)))b|((b(ba|aa)|a([ab][ab]))a|(a(ba|ab)|b(bb))b)a)))a){44})))$"
//        val michaels = "currentRule"
        val michaelsSimplified = simplifyRegex(michaels)
        val superRegex = Regex(michaelsSimplified)
        val matchingData = data.filter { superRegex.matches(it) }
        println(matchingData)
        return matchingData
    }

    private fun simplifyRegex(currentRule: String): String {
        return currentRule
            .replace("\"", "")
            .replace(" ", "")
            .replace("(a)", "a")
            .replace("(b)", "b")
            .replace("(a|b)", "[ab]")
            .replace("(\\k<r8>)", "\\k<r8>")
            .replace("(\\k<r11>)", "\\k<r11>")
            .let { "^$it\$" }
    }


    fun splitIntoRulesAndData(lines: List<String>): Pair<Map<String, String>, List<String>> {
        val rules = mutableMapOf<String, String>()
        val data = mutableListOf<String>()
        val ruleRegex = Regex("^([\\d]+): (.+)$")
        lines.forEach { line ->
            val ruleMatch = ruleRegex.find(line)
            if (ruleMatch != null) {
                val (ruleNum, ruleCode) = ruleMatch.destructured
                rules[ruleNum] = ruleCode
            } else if (line.isNotBlank()) {
                data.add(line)
            }
        }

        return Pair(rules, data)
    }

}
